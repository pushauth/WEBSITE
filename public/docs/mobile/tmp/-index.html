<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->
<head>
    <title>PushAuth API</title>
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="favicon.ico">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <!-- Global CSS -->
    <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css">
    <!-- Plugins CSS -->
    <link rel="stylesheet" href="assets/plugins/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" href="assets/plugins/prism/prism.css">
    <link rel="stylesheet" href="assets/plugins/elegant_font/css/style.css">

    <!-- Theme CSS -->
    <link id="theme-style" rel="stylesheet" href="assets/css/styles.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body class="body-green">
<div class="page-wrapper">
    <!-- ******Header****** -->
    <header id="header" class="header">
        <div class="container">
            <div class="branding">
                <h1 class="logo">
                    <a href="#">
                        <span aria-hidden="true" class="icon_documents_alt icon"></span>
                        <span class="text-highlight">PushAuth</span><span class="text-bold">API</span>
                    </a>
                </h1>
            </div><!--//branding-->
            <ol class="breadcrumb">
                <li><a href="#">Home</a></li>
                <li class="active">MobileAPI</li>
            </ol>
        </div><!--//container-->
    </header><!--//header-->
    <div class="doc-wrapper">
        <div class="container">
            <div id="doc-header" class="doc-header text-center">
                <h1 class="doc-title"><i class="icon fa fa-paper-plane"></i> Mobiles, Pads & Watchs</h1>
                <div class="meta"><i class="fa fa-clock-o"></i> Last updated: 18.03.2017</div>
            </div><!--//doc-header-->
            <div class="doc-body">
                <div class="doc-content">
                    <div class="content-inner">

                        <section id="mobileapi-section" class="doc-section">
                            <h2 class="section-title">Mobile API</h2>
                            <div class="section-block">

                                В данном разделе описаны API для работы мобильных устройств/планшетов/часов с сервером PushAuth.



                            </div>

                            <div id="auth-section"  class="section-block">
                                <h2 class="block-title">Авторизация или регистрация устройства</h2>
                                <div class="section-block">

                                    Данный запрос позволяет авторизировать уже имеющегося пользователя с таким устройством или зарегистрировать нового пользователя либо его устройство на основании одного лишь <span class="label label-success">email</span>. Этап регистрации проходит через отправку сервером письма со ссылкой для подтверждения.
                                    После того как регистрация была подтверждена пользователь снова вводит <span class="label label-success">email</span> и уже проходит авторизацию.



                                </div>

                                <h4 id="auth-send-section" class="block-title">Request</h4>
                                <div class="row">
                                    <div class="col-md-1">
                                        <h6>Method:</h6>
                                        <p><code>POST</code></p>
                                    </div>
                                    <div class="col-md-11">
                                        <h6>API Endpoint:</h6>
                                        <p><code>https://api.pushauth.io/auth</code></p>
                                    </div>

                                </div>


                                <div class="row">
                                    <div class="col-md-6">
                                        <h6>Content-Type:</h6>
                                        <p><code>application/json</code></p>
                                        <div class="code-block">
                                            <h6>Body request example</h6>
                                            <pre><code class="language-json">{
"email":"info@zenlix.com",
"device_uuid":"UUID_NUMBER",
"device_token":"ToKeN",
"device_type":"ios"
}</code></pre>
                                        </div><!--//code-block-->

                                    </div>
                                    <div class="col-md-6">


                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                <tr>
                                                    <th>Param</th>
                                                    <th>Description</th>

                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr>
                                                    <th>email</th>
                                                    <td>Адрес email, который вводится в поле при авторизации/регистрации</td>

                                                </tr>
                                                <tr>
                                                    <th>device_uuid</th>
                                                    <td>Уникальный UUID-устройства, по нему идёт идентификация устройства</td>

                                                </tr>
                                                <tr>
                                                    <th>device_token</th>
                                                    <td>Token устройства, адрес на который будет отправляться PUSH</td>

                                                </tr>
                                                <tr>
                                                    <th>device_type</th>
                                                    <td>Тип устройства, допускается два типа: <strong>ios</strong> или <strong>android</strong></td>

                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>



                                    </div>

                                </div>


                                <hr>
                                <h4 id="auth-recieve-section" class="block-title">Response</h4>
                                <div class="section-block">

                                    Ответ от сервера будет с кодом 200, если регистрация или авторизация прошли успешно, в ином случае - смотрите коды ошибок.



                                </div>
                                <div class="row">
                                    <div class="col-md-6">

                                        <h5 class="block-title">Ответ при регистрации</h5>

                                        <div class="col-md-6"><h6>Content-Type:</h6>
                                            <p><code>application/json</code></p></div>
                                        <div class="col-md-6"><h6>Response Code:</h6>
                                            <p><code>200 OK</code></p></div>




                                        <div class="code-block">
                                            <h6>Body response example</h6>

                                            <pre><code class="language-json">{
"message":"Please check your email for confirmation!"
}</code></pre>



                                        </div><!--//code-block-->

                                    </div>
                                    <div class="col-md-6">


                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                <tr>
                                                    <th>Param</th>
                                                    <th>Description</th>

                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr>
                                                    <th>message</th>
                                                    <td>Текст, в котором содержится объяснение результата запроса</td>

                                                </tr>

                                                </tbody>
                                            </table>
                                        </div>



                                    </div>
                                    <div class="col-md-12">
                                        <div class="callout-block callout-success">
                                            <div class="icon-holder">
                                                <i class="fa fa-thumbs-up"></i>
                                            </div><!--//icon-holder-->
                                            <div class="content">

                                                <p>Регистрация прошла успешно - пользователю на <span class="label label-success">email</span> будет выслано письмо со ссылкой для подтверждения. Можно вывести на экран устройства, типа: Please, check you email for finish registration с кнопкой OK, и снова поле ввода email.</p>
                                            </div><!--//content-->
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">

                                        <h5 class="block-title">Ответ при авторизации</h5>
                                        <div class="col-md-6"><h6>Content-Type:</h6>
                                            <p><code>application/json</code></p></div>
                                        <div class="col-md-6"><h6>Response Code:</h6>
                                            <p><code>200 OK</code></p></div>




                                        <div class="code-block">
                                            <h6>Body response example</h6>

                                            <pre><code class="language-json">{
"message":"Auth success!",
"dh_data":{
"hash":"QyqBcwDjQPqvH27y7QlaMcxyPiYtvhSu",
"val_g":23,
"val_p":411753162397,
"val_ak":192142100624
          }
}</code></pre>



                                        </div><!--//code-block-->


                                    </div>
                                    <div class="col-md-6">
                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                <tr>
                                                    <th>Param</th>
                                                    <th>Description</th>

                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr>
                                                    <th>message</th>
                                                    <td>Текст, в котором содержится объяснение результата запроса</td>

                                                </tr>
                                                <tr>
                                                    <th>dh_data</th>
                                                    <td>JSON-массив, в котором содержатся значения для генерации своего персонального ключа</td>

                                                </tr>
                                                <tr>
                                                    <th>val_g</th>
                                                    <td>Является простым числом, полученным на основании val_g (первообразным корнем по модулю p)</td>

                                                </tr>
                                                <tr>
                                                    <th>val_p</th>
                                                    <td>Является случайным простым числом</td>

                                                </tr>
                                                <tr>
                                                    <th>val_ak</th>
                                                    <td>Является простым числом, полученным на основании вычислений: <span class="label label-success">val_g</span> возведение в степень персонального случайного числа стороны сервера и результат mod <span class="label label-success">val_p</span></td>

                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <div class="col-md-12">
                                        <div class="callout-block callout-success">
                                            <div class="icon-holder">
                                                <i class="fa fa-thumbs-up"></i>
                                            </div><!--//icon-holder-->
                                            <div class="content">

                                                <p>Регистрация прошла успешно - пользователю на <span class="label label-success">email</span> будет выслано письмо со ссылкой для подтверждения. Можно вывести на экран устройства, типа: Please, check you email for finish registration с кнопкой OK, и снова поле ввода email.</p>
                                            </div><!--//content-->
                                        </div>
                                    </div>


                                </div>
                                <div class="row">
                                    <div class="col-md-6">

                                        <h5 class="block-title">Ответ при ошибке (указан не корректный email)</h5>
                                        <div class="col-md-6"><h6>Content-Type:</h6>
                                            <p><code>application/json</code></p></div>
                                        <div class="col-md-6"><h6>Response Code:</h6>
                                            <p><code>422 Unprocessable Entity</code></p></div>




                                        <div class="code-block">
                                            <h6>Body response example</h6>

                                            <pre><code class="language-json">{
"message":"Validating error.",
"errors":{
"email":["The email must be a valid email address."]
},
"status_code":422
}</code></pre>



                                        </div><!--//code-block-->


                                    </div>
                                    <div class="col-md-6">
                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                <tr>
                                                    <th>Param</th>
                                                    <th>Description</th>

                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr>
                                                    <th>message</th>
                                                    <td>Текст, в котором содержится объяснение результата запроса</td>

                                                </tr>
                                                <tr>
                                                    <th>errors</th>
                                                    <td>JSON-массив, в котором содержатся объекты с массивом ошибок</td>

                                                </tr>
                                                <tr>
                                                    <th>status_code</th>
                                                    <td>Код ошибки</td>

                                                </tr>

                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <div class="col-md-12">
                                        <div class="callout-block callout-danger">
                                            <div class="icon-holder">
                                                <i class="fa fa-exclamation-triangle"></i>
                                            </div><!--//icon-holder-->
                                            <div class="content">

                                                <p>В процессе регистрации/авторизации сервер вернул ошибку. Ошибкой расцениваются все ответы, код которых не 200</p>
                                            </div><!--//content-->
                                        </div>
                                    </div>


                                </div>



                            </div>

                            <div id="dh-section"  class="section-block">
                                <h2 class="block-title">Обмен ключами</h2>
                                <div class="section-block">

                                    После успешной регистрации, необходимо произвести обмен ключами. Данная процедура предполагает ряд вычислений, в результате которых, у каждой стороны (сервер и клиент) окажется одинаковый ключ, с помощью которого можно будет шифровать ответы на push и производить обмен информацией с сервером.



                                </div>

                                <h4 id="dh-send-section" class="block-title">Request</h4>
                                <div class="row">
                                    <div class="col-md-1">
                                        <h6>Method:</h6>
                                        <p><code>POST</code></p>
                                    </div>
                                    <div class="col-md-11">
                                        <h6>API Endpoint:</h6>
                                        <p><code>https://api.pushauth.io/auth/dhe</code></p>
                                    </div>

                                </div>


                                <div class="row">
                                    <div class="col-md-6">
                                        <h6>Content-Type:</h6>
                                        <p><code>application/json</code></p>
                                        <div class="code-block">
                                            <h6>Body request example</h6>
                                            <pre><code class="language-json">{
"hash":"aHIrNoSXoVpcd08zpq9KJTfekLxTzT4F",
"val_bk":13634723198
}</code></pre>
                                        </div><!--//code-block-->

                                    </div>
                                    <div class="col-md-6">


                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                <tr>
                                                    <th>Param</th>
                                                    <th>Description</th>

                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr>
                                                    <th>hash</th>
                                                    <td>Hash-идентификатор запроса обмена ключами, полученный при авторизации из параметра <strong>hash</strong></td>

                                                </tr>
                                                <tr>
                                                    <th>val_bk</th>
                                                    <td>Число, которое получено на основе вычислений параметров, полученных из запроса при авторизации. Смотрите ниже алгоритм вычислений.

                                                    </td>

                                                </tr>

                                                </tbody>
                                            </table>
                                        </div>



                                    </div>

                                </div>
                                <h3 id="dh-math-section" class="block-title">Алгоритм вычисления val_bk -параметра</h3>
                                <div class="section-block">

                                    После успешной авторизации, нам доступны три параметра: <code class="language-json">{"val_g":23, "val_p":411753162397, "val_ak":192142100624}</code>

                                    <h4>Очерёдность действий</h4>
                                    <ol class="list">
                                        <li>Генерируем простое 9-ти значное число, назвём его <span class="label label-success">val_b</span>. Данное число остаётся на устройстве, мы его никому не сообщаем.</li>
                                        <li>Число <span class="label label-success">val_g</span> возводим в степень числа <span class="label label-success">val_b</span> и результат по модулю числа <span class="label label-success">val_p</span>. Результат назвём числом <span class="label label-success">val_bk</span>
                                            <br> (папр на С++ это: <pre>(pow(val_g,val_b) % val_p))</pre>

                                        </li>
                                        <li>Сгенерируем число, на основе чисел <span class="label label-success">val_ak</span>, <span class="label label-success">val_b</span>, <span class="label label-success">val_p</span>. Для этого необходимо произвести ряд вычислений. Число <span class="label label-success">val_ak</span> возводим в степень числа <span class="label label-success">val_b</span> и результат по модулю числа <span class="label label-success">val_p</span>. Назвём это число <span class="label label-success">pre_key</span>
                                            <br> (папр на С++ это: <pre>(pow(val_ak,val_b) % val_p))</pre>
                                        </li>

                                        <li>
                                            Сгенерируем приватный ключ. Для этого, число <span class="label label-success">pre_key</span> закодируем в строку, алгоритмом <strong>SHA256</strong>, а потом обрежем строку, сделав длину её в 32 символа.
                                            <br> (папр это: <pre>substr(hash('sha256', pre_key), 0, 32)</pre>
                                            Так мы получим наш приватный ключ, который знаем только мы и сервер. В дальнейшем мы будем использовать его для шифрования.


                                        </li>
                                    </ol>


                                </div>
                                <h4 id="dh-recieve-section" class="block-title">Response</h4>
                                <div class="section-block">

                                    Ответ от сервера будет с кодом 200, если DH-exchange прошла успешно, в ином случае - смотрите коди ошибок.



                                </div>
                                <div class="row">
                                    <div class="col-md-6">

                                        <h5 class="block-title">Ответ при успешном обмене</h5>

                                        <div class="col-md-6"><h6>Content-Type:</h6>
                                            <p><code>application/json</code></p></div>
                                        <div class="col-md-6"><h6>Response Code:</h6>
                                            <p><code>200 OK</code></p></div>




                                        <div class="code-block">
                                            <h6>Body response example</h6>

                                            <pre><code class="language-json">{
"data":"YlRyencwNUU0b2NvTXFPUTl5alhheXlpZnhoTVNqZFhSVWJYd29OakpvYmFkajZTYjdTejdOR2Vicnp4dDN2WC51MoZQEoQAwnbw2RGb6Dvq"
}</code></pre>



                                        </div><!--//code-block-->

                                    </div>
                                    <div class="col-md-6">


                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                <tr>
                                                    <th>Param</th>
                                                    <th>Description</th>

                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr>
                                                    <th>data</th>
                                                    <td>Уже закодированная строка с сообщением. Что бы её раскодировать смотрите ниже алгоритм раскодирования.</td>

                                                </tr>

                                                </tbody>
                                            </table>
                                        </div>



                                    </div>


                                    <div class="col-md-12">
                                        <h3 id="dh-decode-section" class="block-title">Алгоритм раскодирования строки</h3>
                                        <div class="section-block">

                                            После успешной авторизации и обмена числами для генерации ключей, нам доступен приватный ключ.

                                            <h4>Очерёдность действий</h4>
                                            <ol class="list">
                                                <li>Закодированную строку <pre>YlRyencwNUU0b2NvTXFPUTl5alhheXlpZnhoTVNqZFhSVWJYd29OakpvYmFkajZTYjdTejdOR2Vicnp4dDN2WC51MoZQEoQAwnbw2RGb6Dvq</pre> сначала нужно раскодировать (base64_decode). Мы получим строку, разделённую одной точкой: <pre>b"9MTcv2nUabUPrDfAld5+8+AzpJ0tJoDW/6apOcHBxdlyUCyUn+hJIT/JWRt9ptCpN+HeKObhNNdd63pVNy0ObTyVjNU044QQIip9AEg9VK9jDRTQkpsq1X8/ZW7ZLIp2.¯FÅ;Íä²#Jû£@h[´Ú"</pre></li>

                                                <li>Разобъём строку, используя разделительный символ точку, на две строки. Первая её часть будет <strong>данными</strong>, а вторая - <strong>IV-вектор инициализации</strong>. В итоге получим,<br> данные: <pre>b"9MTcv2nUabUPrDfAld5+8+AzpJ0tJoDW/6apOcHBxdlyUCyUn+hJIT/JWRt9ptCpN+HeKObhNNdd63pVNy0ObTyVjNU044QQIip9AEg9VK9jDRTQkpsq1X8/ZW7ZLIp2</pre>
                                                    IV-вектор инициализации: <pre>¯FÅ;Íä²#Jû£@h[´Ú"</pre></li>

                                                <li>Что бы раскодировать строку, мы используем наш <strong>Приватный ключ</strong> и <strong>IV-вектор инициализации</strong>. Раскодирование происходит алгоритмом <strong>AES-256-CBC</strong>. Можно использовать библиотеку OpenSSL
                                                    <br> (папр на PHP это: <pre>openssl_decrypt(ДАННЫЕ, 'aes-256-cbc', ПРИВАТНЫЙ_КЛЮЧ, 0, ВЕКТОР_ИНИЦИАЛИЗАЦИИ);</pre>

                                                </li>

                                                <li>
                                                    Мы получим раскодированные JSON-данные, см ниже.


                                                </li>
                                            </ol>


                                        </div>
                                    </div>







                                </div>


                                <div class="row">
                                    <div class="col-md-6">

                                        <h5 class="block-title">Раскодированая строка</h5>

                                        <div class="col-md-12"><h6>Content-Type:</h6>
                                            <p><code>application/json</code></p></div>





                                        <div class="code-block">
                                            <h6>Encoded data example</h6>

                                            <pre><code class="language-json">{
"message":"Auth and Encrypted success!",
"public_key":"NoUPStvQf0dMF6UaKGsDhaHawZnmY3gJ"
}</code></pre>



                                        </div><!--//code-block-->

                                    </div>
                                    <div class="col-md-6">


                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                <tr>
                                                    <th>Param</th>
                                                    <th>Description</th>

                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr>
                                                    <th>message</th>
                                                    <td>Текст, в котором содержится объяснение результата запроса</td>

                                                </tr>
                                                <tr>
                                                    <th>public_key</th>
                                                    <td>Публичный ключ, который используется для идентификации устройства на сервере, его можно передавать в открытом виде. Его необходимо хранить.</td>

                                                </tr>

                                                </tbody>
                                            </table>
                                        </div>



                                    </div>
                                </div>



                            </div>


</section>
                    </div><!--//section-block-->

                    <div id="push-section"  class="section-block">
                        <h2 id="push-recieve-section" class="block-title">Приём push-сообщений</h2>
                        <div class="section-block">

                            Все данные, полученные через PUSH, в открытом виде и содержат информацию, которая инициализирует то или иное действие на устройстве: показывает сообщение с таймером для подтверждения входа/выхода, либо просто сообщение с кодом, без ожидания каких-либо действий от пользователя.



                        </div>
                        <h4 class="block-title">PUSH</h4>
                        <div class="section-block">

                            В теле содержится параметр data, который содержит json-данные.



                        </div>
                        <div class="row">
                            <div class="col-md-6">

                                <h5 class="block-title"></h5>

                                <div class="col-md-12"><h6>Content-Type:</h6>
                                    <p><code>application/json</code></p></div>





                                <div class="code-block">
                                    <h6>Push body example</h6>

                                    <pre><code class="language-json">{
"req_hash":"someReqHashStr",
"mode":"push",
"code":"123-456",
"app_name":"Facebook"
}</code></pre>



                                </div><!--//code-block-->

                            </div>
                            <div class="col-md-6">


                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                        <tr>
                                            <th>Param</th>
                                            <th>Description</th>

                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <th>req_hash</th>
                                            <td>Уникальный идентификатор запроса</td>
                                        </tr>
                                        <tr>
                                            <th>mode</th>
                                            <td>Режим отображения Push. Может принимать значения: <span class="label label-success">push</span> или <span class="label label-success">code</span>. Значение push - необходимо пользователя спросить, напр: войти ли в сервис с вариантами ответа: да/нет. Значение code - необходимо только отобразить код для входа, с параметра code</td>
                                        </tr>
                                        <tr>
                                            <th>code</th>
                                            <td>Код, который присылает сервис через сервер для того, что бы клиент его ввёл на сайте для авторизации.</td>
                                        </tr>
                                        <tr>
                                            <th>app_name</th>
                                            <td>Название сервиса, для того что бы пользователь понимал, куда ему запрашивается войти.</td>
                                        </tr>

                                        </tbody>
                                    </table>
                                </div>



                            </div>


                            <div class="col-md-12">
                                <h3 id="push-math-section" class="block-title">После получения push</h3>
                                <div class="section-block">

                                    После успешного получения push, необходимо определить параметр <span class="label label-success">mode</span>, от которого зависит дальнейший алгоритм действий.

                                    <h4>Очерёдность действий если параметр <span class="label label-success">mode</span> указан как <span class="label label-success">push</span></h4>
                                    <ol class="list">
                                        <li>Необходимо вывести диалоговое сообщение, в котором должен быть таймер с 30-тью секундами на ответ и вопрос, Вы подтверждаете вход на <span class="label label-success">[название сервиса]</span> </li>

                                        <li>Ответ может быть ввиде кнопок: Да/Нет</li>

                                        <li>После нажатия на кнопку, отправить запрос на сервер (см ниже).
                                        </li>

                                        <li>
                                            Если ответ не дан на протяжении 30 сек, отправить запрос на сервер (см ниже).

                                        </li>
                                        <li>По истичению 30 сек, спрятать сообщение</li>
                                    </ol>
                                    <h4>Очерёдность действий если параметр <span class="label label-success">mode</span> указан как <span class="label label-success">code</span></h4>
                                    <ol class="list">
                                        <li>Необходимо вывести сообщение,в котором должен быть таймер с 30-тью секундами и напр текст: Ваш код авторизации code для входа на app_name </li>
                                        <li>Сразу отправить запрос на сервер (см ниже).</li>
                                        <li>
                                            По истичению 30 сек, спрятать сообщение.

                                        </li>
                                    </ol>

                                </div>
                            </div>







                        </div>







                    </div>



                    <div id="push-send-section"  class="section-block">
                        <h2 class="block-title">Отправка ответа на Push</h2>
                        <div class="section-block">

                            После получения Push, необходимо отправить запрос на сервер. Сделав это либо сразу после получения push, в случае с параметром mode=code, либо по действию ответа пользователя/истечению времени ожидания ответа в случае с режимом push.


                        </div>
                        <h4 class="block-title">Формирования тела ответа</h4>
                        <div class="row">

                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Content-Type:</h6>
                                    <p><code>application/json</code></p>
                                    <div class="code-block">
                                        <h6>Body example</h6>
                                        <pre><code class="language-json">{
"answer":true,
"hash":"RequestHashString"
}</code></pre>
                                    </div><!--//code-block-->

                                </div>
                                <div class="col-md-6">


                                    <div class="table-responsive">
                                        <table class="table">
                                            <thead>
                                            <tr>
                                                <th>Param</th>
                                                <th>Description</th>

                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr>
                                                <th>answer</th>
                                                <td>Ответ на push, может принимать значения <span class="label label-success">true</span> или <span class="label label-success">false</span> (BOOLEAN)</td>

                                            </tr>
                                            <tr>
                                                <th>hash</th>
                                                <td>Уникальный идентификатор запроса, который содержится в push: <span class="label label-success">req_hash</span></td>

                                            </tr>

                                            </tbody>
                                        </table>
                                    </div>



                                </div>


                                <div class="col-md-12">
                                    <h3 id="push-encode-section" class="block-title">Алгоритм кодирования строки</h3>
                                    <div class="section-block">

                                        После успешной авторизации и обмена числами для генерации ключей, нам доступен приватный ключ. Мы будем использовать его для кодирования данных

                                        <h4>Очерёдность действий</h4>
                                        <ol class="list">


                                            <li>Для кодирования строки, необходимы данные(json-строка), приватный ключ и вектор инициализации. Всё есть, кроме последнего - мы сгенерируем <span class="label label-success">IV-вектор инициализации</span>. Это должна быть строка, размером 16 bytes.</li>
                                            <li>Что бы закодировать строку, мы используем наш <span class="label label-success">Приватный ключ</span> и <span class="label label-success">IV-вектор инициализации</span>. Кодирование происходит алгоритмом <strong>AES-256-CBC</strong>. Можно использовать библиотеку OpenSSL
                                                <br> (папр на PHP это: <pre>openssl_encrypt(ДАННЫЕ, 'aes-256-cbc', ПРИВАТНЫЙ_КЛЮЧ, 0, ВЕКТОР_ИНИЦИАЛИЗАЦИИ);</pre> Мы получим строку вида: <pre>b"9MTcv2nUabUPrDfAld5+8+AzpJ0tJoDW/6apOcHBxdlyUCyUn+hJIT/JWRt9ptCpN+HeKObhNNdd63pVNy0ObTyVjNU044QQIip9AEg9VK9jDRTQkpsq1X8/ZW7ZLIp2</pre>
                                            </li>
                                            <li>Нам необходимо соединить закодированную строку и вектор инициализации с помощью знака точка <strong><span class="label label-success">.</span></strong>. Напр: <span class="label label-success">данныестрока<strong>.</strong>ivвектор</span>.
                                                Выйдет так: <pre>b"9MTcv2nUabUPrDfAld5+8+AzpJ0tJoDW/6apOcHBxdlyUCyUn+hJIT/JWRt9ptCpN+HeKObhNNdd63pVNy0ObTyVjNU044QQIip9AEg9VK9jDRTQkpsq1X8/ZW7ZLIp2.¯FÅ;Íä²#Jû£@h[´Ú"</pre></li>

                                            <li>
                                                Необходимо строку с вектором закодировать методом <strong>base64</strong>. Получится строка вида: <pre>YlRyencwNUU0b2NvTXFPUTl5alhheXlpZnhoTVNqZFhSVWJYd29OakpvYmFkajZTYjdTejdOR2Vicnp4dDN2WC51MoZQEoQAwnbw2RGb6Dvq</pre>
                                            </li>



                                        </ol>


                                    </div>


                                </div>



                            </div>

                        </div>

















                    </div>

                    <div id="logout-section"  class="section-block">
                        <h2 class="block-title">Выход из устройства</h2>
                        <div class="section-block">

                            При выходе из устройства, необходимо удалить приватный и публичный ключи. Устройство больше не сможет получить push и отправлять данные.

                        </div>
                        <h4 class="block-title">Request</h4>
                        <div class="row">
                            <div class="col-md-1">
                                <h6>Method:</h6>
                                <p><code>POST</code></p>
                            </div>
                            <div class="col-md-11">
                                <h6>API Endpoint:</h6>
                                <p><code>https://api.pushauth.io/logauth</code></p>
                            </div>

                        </div>


                        <div class="row">
                            <div class="col-md-6">
                                <h6>Content-Type:</h6>
                                <p><code>application/json</code></p>
                                <div class="code-block">
                                    <h6>Body request example</h6>
                                    <pre><code class="language-json">{
"pk":"DevicePublicKey"
}</code></pre>
                                </div><!--//code-block-->

                            </div>
                            <div class="col-md-6">


                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                        <tr>
                                            <th>Param</th>
                                            <th>Description</th>

                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <th>pk</th>
                                            <td>Публичный ключ устройства</td>

                                        </tr>

                                        </tbody>
                                    </table>
                                </div>



                            </div>

                        </div>


                        <hr>
                        <h4 class="block-title">Response</h4>
                        <div class="section-block">

                            Ответ от сервера будет с кодом 200, если удаление устройства прошло успешно, в ином случае - смотрите коды ошибок.



                        </div>
                        <div class="row">
                            <div class="col-md-6">

                                <h5 class="block-title">Ответ</h5>

                                <div class="col-md-6"><h6>Content-Type:</h6>
                                    <p><code>application/json</code></p></div>
                                <div class="col-md-6"><h6>Response Code:</h6>
                                    <p><code>200 OK</code></p></div>




                                <div class="code-block">
                                    <h6>Body response example</h6>

                                    <pre><code class="language-json">{
"message":"Device deleted successful!"
}</code></pre>



                                </div><!--//code-block-->

                            </div>
                            <div class="col-md-6">


                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                        <tr>
                                            <th>Param</th>
                                            <th>Description</th>

                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <th>message</th>
                                            <td>Текст, в котором содержится объяснение результата запроса</td>

                                        </tr>

                                        </tbody>
                                    </table>
                                </div>



                            </div>

                        </div>









<div class="row">
                    <div id="security-section"  class="section-block">
                        <h2 class="block-title">Безопасность устройства</h2>
                        <div class="section-block">
Предполагается что после регистрации приложение всё время хранит публичный и приватный ключ. Необходимо должным образом хранить данные значения, особенно приватный ключ, что бы другие приложения или сервисы не смогли получить к данным переменным доступ.<br>
Желательно, что бы приложение имело дополнительные настройки безопасности: TouchID, или вход по 4-х значному коду. Например, если пользователь делает ошибку 3 раза при вводе 4-х значного кода, автоматически вылогинивать устройство.

                        </div>
                        </div>
</div>



                        

<div class="row">
                    <div id="errors-section"  class="section-block">
                        <h2 class="block-title">Коды ошибок</h2>
                        <div class="section-block">
В данном разделе описываются основные коды ошибок, при запросах. Если код 4xx или 5xx, то скорее всего будет присутствовать json значения: <span class="label label-success">status_code</span> и <span class="label label-success">message</span>.

                        </div>



<div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                        <tr>
                                            <th>Code</th>
                                            <th>Description</th>

                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <th>200 OK</th>
                                            <td>Успешно обработан запрос.</td>

                                        </tr>
                                        <tr>
                                            <th>403 Access Denied</th>
                                            <td>Доступ запрещён, возможно пользователь или устройство заблокированы</td>

                                        </tr>
                                        <tr>
                                            <th>404 Not Found</th>
                                            <td>Не найдено</td>

                                        </tr>
                                        <tr>
                                            <th>422 Unprocessable Entity</th>
                                            <td>Ошибка в параметре запроса</td>

                                        </tr>
                                        <tr>
                                            <th>500 Internal Server Error</th>
                                            <td>Ошибка на сервере</td>

                                        </tr>


                                        </tbody>
                                    </table>
                                </div>

                        </div>
</div>

















                        </section><!--//doc-section-->
                    </div><!--//content-inner-->
                </div><!--//doc-content-->
                <div class="doc-sidebar hidden-xs">
                    <nav id="doc-nav">
                        <ul id="doc-menu" class="nav doc-menu" data-spy="affix">

                            <li>
                                <a class="scrollto" href="#auth-section">Авторизация/Регистрация</a>
                                <ul class="nav doc-sub-menu">
                                    <li><a class="scrollto" href="#auth-send-section">Отправка запроса</a></li>
                                    <li><a class="scrollto" href="#auth-recieve-section">Получение ответа</a></li>

                                </ul><!--//nav-->
                            </li>

                            <li>
                                <a class="scrollto" href="#dh-section">Обмен ключами</a>
                                <ul class="nav doc-sub-menu">
                                    <li><a class="scrollto" href="#dh-send-section">Отправка запроса</a></li>
                                    <li><a class="scrollto" href="#dh-math-section">Вычисления</a></li>
                                    <li><a class="scrollto" href="#dh-recieve-section">Обработка ответа</a></li>
                                    <li><a class="scrollto" href="#dh-decode-section">Декодирование</a></li>

                                </ul><!--//nav-->
                            </li>
                            <li>
                                <a class="scrollto" href="#push-section">PUSH</a>
                                <ul class="nav doc-sub-menu">
                                    <li><a class="scrollto" href="#push-recieve-section">Приём</a></li>
                                    <li><a class="scrollto" href="#push-math-section">Обработка</a></li>
                                    <li><a class="scrollto" href="#push-send-section">Отправка ответа</a></li>
                                    <li><a class="scrollto" href="#push-encode-section">Кодирование</a></li>

                                </ul><!--//nav-->
                            </li>
                            <li><a class="scrollto" href="#logout-section">Выход из устройства</a></li>
                            <li><a class="scrollto" href="#security-section">Безопасность устройства</a></li>
                            <li><a class="scrollto" href="#errors-section">Коды ошибок</a></li>


                        </ul><!--//doc-menu-->
                    </nav>
                </div><!--//doc-sidebar-->
            </div><!--//doc-body-->
        </div><!--//container-->
    </div><!--//doc-wrapper-->

    <div id="promo-block" class="promo-block">
        <div class="container">
            <div class="promo-block-inner">
                <h3 class="promo-title text-center"><i class="fa fa-heart"></i> PushAuth - приложение, которое помогает людям не помнить пароли.</h3>
                <div class="row">
                    
                    <div class="content-holder col-md-12">
                        <div class="content-holder-inner">
                            <div class="desc">
                                <h4 class="content-title"><strong>Есть вопросы или нашли ошибку?</strong></h4>
                                <p>Я всегда готов помочь, пишите мне: info@snisar.com or Skype: rustem_ck</p>
                            </div><!--//desc-->
                            <div class="author"><a href="http://snisar.com">Y.Snisar</a></div>
                        </div><!--//content-holder-inner-->
                    </div><!--//content-holder-->
                </div><!--//row-->
            </div><!--//promo-block-inner-->
        </div><!--//container-->
    </div><!--//promo-block-->

</div><!--//page-wrapper-->

<footer id="footer" class="footer text-center">
    <div class="container">
        <!--/* This template is released under the Creative Commons Attribution 3.0 License. Please keep the attribution link below when using for your own project. Thank you for your support. :) If you'd like to use the template without the attribution, you can check out other license options via our website: themes.3rdwavemedia.com */-->
        <small class="copyright">Documented with <i class="fa fa-heart"></i> by <a href="№" targe="_blank">Y.Snisar</a> for developers</small>

    </div><!--//container-->
</footer><!--//footer-->


<!-- Main Javascript -->
<script type="text/javascript" src="assets/plugins/jquery-1.12.3.min.js"></script>
<script type="text/javascript" src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="assets/plugins/prism/prism.js"></script>
<script type="text/javascript" src="assets/plugins/jquery-scrollTo/jquery.scrollTo.min.js"></script>
<script type="text/javascript" src="assets/plugins/jquery-match-height/jquery.matchHeight-min.js"></script>
<script type="text/javascript" src="assets/js/main.js"></script>

</body>
</html> 

